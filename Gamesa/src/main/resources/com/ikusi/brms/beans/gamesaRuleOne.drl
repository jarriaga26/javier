package com.ikusi.brms.beans;



query "isOnMemory" (Request request) 
     System.out.println("request on query:"+request);
     req: Request(getInMemory(), getDevice().getSysId() == request.getDevice().getSysId());
end



rule "test envio request"

when 
    request : Request( getEvent().getName()== "Test_0_3_XXX" )
then
    System.out.println("regla evaluada ver 1.0:"+request.getEvent().getName());
    request.getEvent().setName("Succes");
    request.getResponse().setResultado("CREATE");
    request.getResponse().setTiempoEspera(2);

    update( request );
    
end    

rule "device no en memoria" 
   no-loop 
when
    request : Request( getEvent().getName()== "Test_0_3_XXX" )
    not isOnMemory(req:request)
then 
    System.out.println("entra a regla nueva");
    request.setInMemory(true);
    System.out.println("add...");
    update( request );
end


rule "device en memoria" 
   no-loop 
when
    request : Request( getEvent().getName()== "Test_0_3_XXX" )
    isOnMemory(req:request)
then 
    System.out.println("ya esta en memoria");
end

